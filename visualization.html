<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è±†ç“£ç”µå½±Top250å¯è§†åŒ–åˆ†æ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }
        
        /* åŠ¨æ€èƒŒæ™¯æ•ˆæœ */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 80%, rgba(255, 107, 107, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(78, 205, 196, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 40% 40%, rgba(255, 209, 102, 0.05) 0%, transparent 50%),
                        radial-gradient(circle at 60% 60%, rgba(6, 214, 160, 0.05) 0%, transparent 50%);
            animation: float 20s ease-in-out infinite;
            z-index: -1;
        }
        
        @keyframes float {
            0%, 100% {
                transform: translateY(0px) rotate(0deg);
            }
            25% {
                transform: translateY(-20px) rotate(1deg);
            }
            50% {
                transform: translateY(0px) rotate(0deg);
            }
            75% {
                transform: translateY(20px) rotate(-1deg);
            }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 50px;
            color: white;
            padding: 40px 20px;
            position: relative;
        }

        .header h1 {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3),
                        0 0 20px rgba(255, 255, 255, 0.2);
            background: linear-gradient(45deg, #fff, #f0f0f0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: titlePulse 3s ease-in-out infinite;
            position: relative;
            z-index: 1;
        }

        .header p {
            font-size: 1.3rem;
            opacity: 0.95;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
            background: linear-gradient(45deg, #fff, rgba(255, 255, 255, 0.8));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: subtitleFade 4s ease-in-out infinite;
        }

        @keyframes titlePulse {
            0%, 100% {
                transform: scale(1);
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3),
                            0 0 20px rgba(255, 255, 255, 0.2);
            }
            50% {
                transform: scale(1.02);
                text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.4),
                            0 0 30px rgba(255, 255, 255, 0.3);
            }
        }

        @keyframes subtitleFade {
            0%, 100% {
                opacity: 0.95;
            }
            50% {
                opacity: 0.8;
            }
        }

        /* è£…é¥°æ€§å…ƒç´  */
        .header::before,
        .header::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 100px;
            height: 3px;
            background: linear-gradient(to right, transparent, rgba(255, 255, 255, 0.5), transparent);
        }

        .header::before {
            left: 0;
            transform: translateY(-50%);
        }

        .header::after {
            right: 0;
            transform: translateY(-50%);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 25px;
            margin-bottom: 50px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.98);
            padding: 30px 25px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12),
                        0 1px 3px rgba(0, 0, 0, 0.08);
            backdrop-filter: blur(15px);
            text-align: center;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, 
                        transparent 0%, 
                        rgba(255, 255, 255, 0.1) 30%, 
                        rgba(255, 255, 255, 0.2) 50%, 
                        rgba(255, 255, 255, 0.1) 70%, 
                        transparent 100%);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
            z-index: 0;
        }

        .stat-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 8px;
            background: linear-gradient(90deg, var(--card-color), var(--card-color) 50%, transparent);
            opacity: 0;
            transform: scaleX(0);
            transition: all 0.4s ease;
            z-index: 1;
        }

        .stat-card:hover {
            transform: translateY(-10px) scale(1.03);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2),
                        0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .stat-card:hover::before {
            transform: translateX(100%);
        }

        .stat-card:hover::after {
            opacity: 1;
            transform: scaleX(1);
        }

        /* ä¸ºä¸åŒå¡ç‰‡è®¾ç½®ä¸åŒçš„ä¸»é¢˜è‰²å’Œå›¾æ ‡ */
        .stat-card:nth-child(1) {
            --card-color: #FF6B6B;
        }

        .stat-card:nth-child(2) {
            --card-color: #4ECDC4;
        }

        .stat-card:nth-child(3) {
            --card-color: #FFD166;
        }

        .stat-card:nth-child(4) {
            --card-color: #06D6A0;
        }

        /* äº¤äº’æ§åˆ¶åŒºåŸŸæ ·å¼ */
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #FF6B6B, #EF476F);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #4ECDC4, #118AB2);
            color: white;
        }

        .btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.25);
        }

        .btn:active {
            transform: translateY(1px) scale(0.98);
        }

        /* å“åº”å¼æŒ‰é’®æ ·å¼ */
        @media (max-width: 480px) {
            .btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
        }

        .stat-number {
            font-size: 3rem;
            font-weight: 800;
            color: var(--card-color);
            margin-bottom: 8px;
            text-shadow: 0 3px 8px rgba(0, 0, 0, 0.15);
            position: relative;
            z-index: 1;
            animation: numberGlow 3s ease-in-out infinite;
        }

        @keyframes numberGlow {
            0%, 100% {
                filter: drop-shadow(0 0 5px rgba(0, 0, 0, 0.1));
            }
            50% {
                filter: drop-shadow(0 0 10px var(--card-color)) drop-shadow(0 0 20px var(--card-color));
            }
        }

        .stat-label {
            font-size: 1.1rem;
            color: #555;
            font-weight: 600;
            position: relative;
            z-index: 1;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(520px, 1fr));
            gap: 35px;
            margin-bottom: 40px;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.98);
            padding: 35px;
            border-radius: 25px;
            box-shadow: 0 12px 48px rgba(0, 0, 0, 0.12),
                        0 2px 8px rgba(0, 0, 0, 0.08);
            backdrop-filter: blur(20px);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.4);
        }

        .chart-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 10px;
            background: linear-gradient(90deg, 
                        var(--card-color, #FF6B6B), 
                        var(--card-color, #FF6B6B) 33%, 
                        #4ECDC4 33%, 
                        #4ECDC4 66%, 
                        #FFD166 66%, 
                        #FFD166);
            opacity: 0;
            transform: scaleX(0);
            transition: all 0.4s ease;
        }

        .chart-container::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, 
                        transparent 0%, 
                        rgba(255, 255, 255, 0.1) 30%, 
                        rgba(255, 255, 255, 0.2) 50%, 
                        rgba(255, 255, 255, 0.1) 70%, 
                        transparent 100%);
            transform: rotate(45deg);
            opacity: 0;
            transition: all 0.6s ease;
        }

        .chart-container:hover {
            transform: translateY(-8px) scale(1.01);
            box-shadow: 0 20px 70px rgba(0, 0, 0, 0.18),
                        0 4px 12px rgba(0, 0, 0, 0.12);
        }

        .chart-container:hover::before {
            opacity: 1;
            transform: scaleX(1);
        }

        .chart-container:hover::after {
            opacity: 1;
            animation: shimmer 1.5s ease-in-out;
        }

        @keyframes shimmer {
            0% {
                transform: translateX(-100%) translateY(-100%) rotate(45deg);
            }
            100% {
                transform: translateX(100%) translateY(100%) rotate(45deg);
            }
        }

        .chart-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: #333;
            text-align: center;
        }

        .chart-wrapper {
            position: relative;
            height: 400px;
        }

        /* å“åº”å¼è®¾è®¡ - é’ˆå¯¹ä¸åŒè®¾å¤‡å°ºå¯¸ä¼˜åŒ– */
        @media (max-width: 1024px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-container {
                padding: 25px;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .header p {
                font-size: 1rem;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
            
            .stat-card {
                padding: 20px;
            }
            
            .stat-number {
                font-size: 2rem;
            }
            
            .chart-container {
                padding: 20px;
            }
            
            .chart-title {
                font-size: 1.3rem;
            }
            
            /* è°ƒæ•´å›¾è¡¨å¤§å°ä»¥é€‚åº”ç§»åŠ¨è®¾å¤‡ */
            .chart-wrapper {
                height: 300px;
            }
        }
        
        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.8rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            /* åœ¨å°å±å¹•ä¸Šéšè—æ•°æ®æ ‡ç­¾ä»¥é¿å…æ‹¥æŒ¤ */
            .chart-container .chartjs-datalabels {
                display: none;
            }
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
            font-size: 1.2rem;
            color: #666;
        }

        /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¬ è±†ç“£ç”µå½±Top250å¯è§†åŒ–åˆ†æ</h1>
            <p>æ¢ç´¢ç”µå½±ä¸–ç•Œçš„ç²¾å½©æ•°æ®</p>
        </div>

        <!-- äº¤äº’æ§åˆ¶åŒºåŸŸ -->
        <div class="controls">
            <button id="updateBtn" class="btn btn-primary">ğŸ”„ æ›´æ–°æ•°æ®</button>
            <button id="toggleChartsBtn" class="btn btn-secondary">ğŸ“Š åˆ‡æ¢å›¾è¡¨è§†å›¾</button>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="totalMovies">250</div>
                <div class="stat-label">æ€»ç”µå½±æ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="avgRating">9.0</div>
                <div class="stat-label">å¹³å‡è¯„åˆ†</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="maxRating">9.7</div>
                <div class="stat-label">æœ€é«˜è¯„åˆ†</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="yearRange">87</div>
                <div class="stat-label">å¹´ä»½è·¨åº¦</div>
            </div>
        </div>

        <div class="charts-grid">
            <div class="chart-container">
                <div class="chart-title">â­ è¯„åˆ†åˆ†å¸ƒ</div>
                <div class="chart-wrapper">
                    <canvas id="ratingDistributionChart"></canvas>
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">ğŸ“… æ¯å¹´å…¥é€‰å½±ç‰‡æ•°é‡</div>
                <div class="chart-wrapper">
                    <canvas id="yearDistributionChart"></canvas>
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">ğŸ­ ç”µå½±ç±»å‹åˆ†å¸ƒ</div>
                <div class="chart-wrapper">
                    <canvas id="genreDistributionChart"></canvas>
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">ğŸ“Š è¯„åˆ†ä¸è¯„ä»·äººæ•°å…³ç³»</div>
                <div class="chart-wrapper">
                    <canvas id="ratingVsCountChart"></canvas>
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">ğŸ† è¯„åˆ†æœ€é«˜çš„Top10ç”µå½±</div>
                <div class="chart-wrapper">
                    <canvas id="topMoviesChart"></canvas>
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">ğŸ“ˆ å¹´ä»£è¯„åˆ†è¶‹åŠ¿</div>
                <div class="chart-wrapper">
                    <canvas id="decadeRatingChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <script>
        // çœŸå®æ•°æ®å°†ä»JSONæ–‡ä»¶åŠ è½½
        let movieData = {};
        
        // ä»JSONæ–‡ä»¶åŠ è½½æ•°æ®
        async function loadMovieData() {
            try {
                const response = await fetch('movie_data.json');
                movieData = await response.json();
                console.log('æ•°æ®åŠ è½½æˆåŠŸ:', movieData);
                return true;
            } catch (error) {
                console.log('ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®:', error);
                // ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ä½œä¸ºå¤‡ä»½
                movieData = {
                    ratingDistribution: [
                        { rating: '8.0-8.4', count: 25 },
                        { rating: '8.5-8.9', count: 65 },
                        { rating: '9.0-9.4', count: 120 },
                        { rating: '9.5-9.9', count: 40 }
                    ],
                    yearDistribution: [
                        { year: 1994, count: 7 },
                        { year: 1999, count: 8 },
                        { year: 2001, count: 6 },
                        { year: 2003, count: 5 },
                        { year: 2004, count: 7 },
                        { year: 2006, count: 8 },
                        { year: 2008, count: 9 },
                        { year: 2010, count: 7 },
                        { year: 2014, count: 6 },
                        { year: 2019, count: 5 }
                    ],
                    genreDistribution: [
                        { genre: 'å‰§æƒ…', count: 180 },
                        { genre: 'çˆ±æƒ…', count: 95 },
                        { genre: 'å–œå‰§', count: 70 },
                        { genre: 'ç§‘å¹»', count: 55 },
                        { genre: 'çŠ¯ç½ª', count: 50 },
                        { genre: 'åŠ¨ç”»', count: 45 },
                        { genre: 'å†’é™©', count: 40 },
                        { genre: 'æ‚¬ç–‘', count: 35 }
                    ],
                    ratingVsCount: [
                        { rating: 9.7, count: 2200000 },
                        { rating: 9.6, count: 1800000 },
                        { rating: 9.5, count: 2000000 },
                        { rating: 9.4, count: 1500000 },
                        { rating: 9.3, count: 1200000 },
                        { rating: 9.2, count: 1000000 },
                        { rating: 9.1, count: 900000 },
                        { rating: 9.0, count: 800000 },
                        { rating: 8.9, count: 700000 },
                        { rating: 8.8, count: 600000 }
                    ],
                    topMovies: [
                        { title: 'è‚–ç”³å…‹çš„æ•‘èµ', rating: 9.7, year: 1994 },
                        { title: 'éœ¸ç‹åˆ«å§¬', rating: 9.6, year: 1993 },
                        { title: 'é˜¿ç”˜æ­£ä¼ ', rating: 9.5, year: 1994 },
                        { title: 'æ³°å¦å°¼å…‹å·', rating: 9.4, year: 1997 },
                        { title: 'è¿™ä¸ªæ€æ‰‹ä¸å¤ªå†·', rating: 9.4, year: 1994 },
                        { title: 'åƒä¸åƒå¯»', rating: 9.4, year: 2001 },
                        { title: 'ç¾ä¸½äººç”Ÿ', rating: 9.5, year: 1997 },
                        { title: 'æ˜Ÿé™…ç©¿è¶Š', rating: 9.4, year: 2014 },
                        { title: 'ç›—æ¢¦ç©ºé—´', rating: 9.4, year: 2010 },
                        { title: 'æ¥šé—¨çš„ä¸–ç•Œ', rating: 9.3, year: 1998 }
                    ],
                    decadeRating: [
                        { decade: '1930s', avgRating: 9.1 },
                        { decade: '1940s', avgRating: 9.0 },
                        { decade: '1950s', avgRating: 9.2 },
                        { decade: '1960s', avgRating: 9.3 },
                        { decade: '1970s', avgRating: 9.2 },
                        { decade: '1980s', avgRating: 9.1 },
                        { decade: '1990s', avgRating: 9.3 },
                        { decade: '2000s', avgRating: 9.2 },
                        { decade: '2010s', avgRating: 9.1 }
                    ]
                };
                return false;
            }
        };

        // é¢œè‰²ä¸»é¢˜ - æ›´é²œè‰³ã€æ›´ç°ä»£çš„é…è‰²æ–¹æ¡ˆ
        const colors = {
            primary: '#FF6B6B',
            secondary: '#4ECDC4',
            accent1: '#FFD166',
            accent2: '#06D6A0',
            accent3: '#118AB2',
            accent4: '#EF476F',
            accent5: '#FF9F1C',
            accent6: '#8338EC',
            gradient: ['#FF6B6B', '#4ECDC4', '#FFD166', '#06D6A0', '#118AB2', '#EF476F', '#FF9F1C', '#8338EC'],
            chartColors: [
                'rgba(255, 107, 107, 0.85)',
                'rgba(78, 205, 196, 0.85)',
                'rgba(255, 209, 102, 0.85)',
                'rgba(6, 214, 160, 0.85)',
                'rgba(17, 138, 178, 0.85)',
                'rgba(239, 71, 111, 0.85)',
                'rgba(255, 159, 28, 0.85)',
                'rgba(131, 56, 236, 0.85)'
            ],
            backgroundGradient: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)'
        };

        // åˆå§‹åŒ–æ‰€æœ‰å›¾è¡¨
        function initCharts() {
            initRatingDistributionChart();
            initYearDistributionChart();
            initGenreDistributionChart();
            initRatingVsCountChart();
            initTopMoviesChart();
            initDecadeRatingChart();
        }

        // è¯„åˆ†åˆ†å¸ƒå›¾è¡¨ - ä½¿ç”¨æ¸å˜å’Œæ›´ç°ä»£çš„æ ·å¼
        function initRatingDistributionChart() {
            const ctx = document.getElementById('ratingDistributionChart').getContext('2d');
            
            // åˆ›å»ºæ¸å˜
            const gradient = ctx.createLinearGradient(0, 0, 0, 400);
            gradient.addColorStop(0, 'rgba(255, 107, 107, 0.9)');
            gradient.addColorStop(1, 'rgba(255, 107, 107, 0.3)');
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: movieData.ratingDistribution.map(item => item.rating),
                    datasets: [{
                        label: 'ç”µå½±æ•°é‡',
                        data: movieData.ratingDistribution.map(item => item.count),
                        backgroundColor: [
                            'rgba(255, 107, 107, 0.85)',
                            'rgba(78, 205, 196, 0.85)',
                            'rgba(255, 209, 102, 0.85)',
                            'rgba(6, 214, 160, 0.85)'
                        ],
                        borderColor: [
                            'rgba(255, 107, 107, 1)',
                            'rgba(78, 205, 196, 1)',
                            'rgba(255, 209, 102, 1)',
                            'rgba(6, 214, 160, 1)'
                        ],
                        borderWidth: 3,
                        borderRadius: 10,
                        borderSkipped: false,
                        barThickness: 70
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            padding: 12,
                            borderRadius: 8,
                            titleFont: {
                                size: 14,
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 13
                            },
                            displayColors: true,
                            callbacks: {
                                label: function(context) {
                                    return `ç”µå½±æ•°é‡: ${context.parsed.y}`;
                                }
                            }
                        },
                        datalabels: {
                            anchor: 'end',
                            align: 'top',
                            color: '#333',
                            font: {
                                size: 15,
                                weight: 'bold'
                            },
                            formatter: (value) => `${value}`
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)',
                                drawBorder: false
                            },
                            ticks: {
                                font: {
                                    size: 12
                                },
                                padding: 10
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 13,
                                    weight: '500'
                                },
                                padding: 15
                            }
                        }
                    },
                    animation: {
                        duration: 1500,
                        easing: 'easeOutElastic(1, .5)'
                    }
                },
                plugins: [ChartDataLabels]
            });
        }

        // å¹´ä»½åˆ†å¸ƒå›¾è¡¨ - ä½¿ç”¨é¢ç§¯å›¾å’Œæ¸å˜æ•ˆæœ
        function initYearDistributionChart() {
            const ctx = document.getElementById('yearDistributionChart').getContext('2d');
            
            // åˆ›å»ºæ¸å˜å¡«å……
            const gradient = ctx.createLinearGradient(0, 0, 0, 400);
            gradient.addColorStop(0, 'rgba(255, 107, 107, 0.4)');
            gradient.addColorStop(1, 'rgba(255, 107, 107, 0.05)');
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: movieData.yearDistribution.map(item => item.year),
                    datasets: [{
                        label: 'å…¥é€‰æ•°é‡',
                        data: movieData.yearDistribution.map(item => item.count),
                        borderColor: '#FF6B6B',
                        backgroundColor: gradient,
                        borderWidth: 4,
                        fill: true,
                        tension: 0.5,
                        pointBackgroundColor: '#FF6B6B',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 3,
                        pointRadius: 8,
                        pointHoverRadius: 12,
                        pointHoverBackgroundColor: '#FF6B6B',
                        pointHoverBorderColor: '#fff',
                        pointHoverBorderWidth: 4,
                        pointShadowColor: 'rgba(255, 107, 107, 0.5)',
                        pointShadowBlur: 10,
                        pointShadowOffsetX: 0,
                        pointShadowOffsetY: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.85)',
                            padding: 15,
                            borderRadius: 10,
                            titleFont: {
                                size: 14,
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 13
                            },
                            callbacks: {
                                label: function(context) {
                                    return `å…¥é€‰æ•°é‡: ${context.parsed.y}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)',
                                drawBorder: false
                            },
                            ticks: {
                                font: {
                                    size: 12
                                },
                                padding: 10
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 12,
                                    weight: '500'
                                },
                                padding: 15
                            }
                        }
                    },
                    animation: {
                        duration: 2000,
                        easing: 'easeOutQuart'
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    }
                }
            });
        }

        // ç±»å‹åˆ†å¸ƒå›¾è¡¨ - ä½¿ç”¨ç¯å½¢å›¾å’Œæ›´ç°ä»£çš„æ ·å¼
        function initGenreDistributionChart() {
            const ctx = document.getElementById('genreDistributionChart').getContext('2d');
            
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: movieData.genreDistribution.map(item => item.genre),
                    datasets: [{
                        data: movieData.genreDistribution.map(item => item.count),
                        backgroundColor: [
                            'rgba(255, 107, 107, 0.85)',
                            'rgba(78, 205, 196, 0.85)',
                            'rgba(255, 209, 102, 0.85)',
                            'rgba(6, 214, 160, 0.85)',
                            'rgba(17, 138, 178, 0.85)',
                            'rgba(239, 71, 111, 0.85)',
                            'rgba(255, 159, 28, 0.85)',
                            'rgba(131, 56, 236, 0.85)'
                        ],
                        borderColor: '#fff',
                        borderWidth: 4,
                        hoverOffset: 20,
                        hoverBackgroundColor: [
                            'rgba(255, 107, 107, 1)',
                            'rgba(78, 205, 196, 1)',
                            'rgba(255, 209, 102, 1)',
                            'rgba(6, 214, 160, 1)',
                            'rgba(17, 138, 178, 1)',
                            'rgba(239, 71, 111, 1)',
                            'rgba(255, 159, 28, 1)',
                            'rgba(131, 56, 236, 1)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                padding: 25,
                                font: {
                                    size: 13,
                                    weight: '500'
                                },
                                usePointStyle: true,
                                padding: 20,
                                boxWidth: 12
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.85)',
                            padding: 15,
                            borderRadius: 10,
                            titleFont: {
                                size: 14,
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 13
                            },
                            callbacks: {
                                label: function(context) {
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const value = context.parsed;
                                    const percentage = Math.round((value / total) * 100);
                                    return `${context.label}: ${value} éƒ¨ (${percentage}%)`;
                                }
                            }
                        },
                        datalabels: {
                            color: '#fff',
                            font: {
                                size: 15,
                                weight: 'bold'
                            },
                            formatter: (value, ctx) => {
                                const total = ctx.dataset.data.reduce((a, b) => a + b, 0);
                                const percentage = Math.round((value / total) * 100);
                                return `${percentage}%`;
                            }
                        }
                    },
                    cutout: '70%',
                    animation: {
                        animateScale: true,
                        animateRotate: true,
                        duration: 1500,
                        easing: 'easeOutElastic(1, .5)'
                    },
                    hover: {
                        mode: 'nearest',
                        intersect: true
                    }
                },
                plugins: [ChartDataLabels]
            });
        }

        // è¯„åˆ†ä¸è¯„ä»·äººæ•°å…³ç³»å›¾è¡¨ - å¢å¼ºäº¤äº’æ€§å’Œè§†è§‰æ•ˆæœ
        function initRatingVsCountChart() {
            const ctx = document.getElementById('ratingVsCountChart').getContext('2d');
            
            // åˆ›å»ºæ¸å˜æ°”æ³¡æ•ˆæœ
            const bubbleGradient = ctx.createRadialGradient(0, 0, 0, 0, 0, 10);
            bubbleGradient.addColorStop(0, 'rgba(255, 255, 255, 0.9)');
            bubbleGradient.addColorStop(0.5, colors.secondary);
            bubbleGradient.addColorStop(1, colors.secondary.replace('0.85', '0.5'));
            
            new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'ç”µå½±',
                        data: movieData.ratingVsCount.map(item => ({
                            x: item.rating,
                            y: item.count / 10000 // è½¬æ¢ä¸ºä¸‡äºº
                        })),
                        backgroundColor: colors.secondary,
                        borderColor: colors.secondary,
                        borderWidth: 3,
                        radius: 10,
                        hoverRadius: 16,
                        hoverBackgroundColor: colors.primary,
                        hoverBorderColor: colors.primary,
                        hoverBorderWidth: 4,
                        pointShadowColor: 'rgba(0, 0, 0, 0.3)',
                        pointShadowBlur: 10,
                        pointShadowOffsetX: 0,
                        pointShadowOffsetY: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.85)',
                            padding: 15,
                            borderRadius: 10,
                            titleFont: {
                                size: 14,
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 13
                            },
                            callbacks: {
                                label: function(context) {
                                    return [
                                        `è¯„åˆ†: ${context.parsed.x}`,
                                        `è¯„ä»·äººæ•°: ${(context.parsed.y * 10000).toLocaleString()} äºº`
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'è¯„åˆ†',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                },
                                color: '#333'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)',
                                drawBorder: false
                            },
                            ticks: {
                                font: {
                                    size: 12
                                },
                                padding: 10
                            },
                            min: 8.5,
                            max: 10
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'è¯„ä»·äººæ•°ï¼ˆä¸‡äººï¼‰',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                },
                                color: '#333'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)',
                                drawBorder: false
                            },
                            ticks: {
                                font: {
                                    size: 12
                                },
                                padding: 10,
                                callback: function(value) {
                                    return value + 'ä¸‡';
                                }
                            }
                        }
                    },
                    animation: {
                        duration: 2000,
                        easing: 'easeOutElastic(1, .5)',
                        onProgress: function(animation) {
                            const chart = this;
                            if (animation.currentStep === animation.numSteps - 1) {
                                // åŠ¨ç”»ç»“æŸæ—¶æ·»åŠ ä¸€ç‚¹æ•ˆæœ
                                chart.data.datasets[0].radius = 10;
                                chart.update('none');
                            }
                        }
                    },
                    interaction: {
                        mode: 'point',
                        intersect: false,
                        axis: 'xy'
                    }
                }
            });
        }

        // Top10ç”µå½±å›¾è¡¨ - ä½¿ç”¨æ¸å˜å’Œå¢å¼ºçš„è§†è§‰æ•ˆæœ
        function initTopMoviesChart() {
            const ctx = document.getElementById('topMoviesChart').getContext('2d');
            
            // ä¸ºæ¯ä¸ªæ¡å½¢åˆ›å»ºç‹¬ç‰¹çš„æ¸å˜
            const createBarGradient = (index, color) => {
                const gradient = ctx.createLinearGradient(0, 0, 400, 0);
                gradient.addColorStop(0, color.replace('0.85', '0.6'));
                gradient.addColorStop(1, color.replace('0.85', '1'));
                return gradient;
            };
            
            // è·å–é¢œè‰²å¹¶åˆ›å»ºæ¸å˜æ•°ç»„
            const barGradients = colors.chartColors.map((color, index) => 
                createBarGradient(index, color)
            );
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: movieData.topMovies.map(item => item.title),
                    datasets: [{
                        label: 'è¯„åˆ†',
                        data: movieData.topMovies.map(item => item.rating),
                        backgroundColor: barGradients,
                        borderColor: colors.chartColors.map(color => color.replace('0.85', '1')),
                        borderWidth: 4,
                        borderRadius: [0, 15, 15, 0],
                        barThickness: 30,
                        borderSkipped: false
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.85)',
                            padding: 15,
                            borderRadius: 10,
                            titleFont: {
                                size: 14,
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 13
                            },
                            callbacks: {
                                label: function(context) {
                                    const movie = movieData.topMovies[context.dataIndex];
                                    return [
                                        `è¯„åˆ†: ${movie.rating}`,
                                        `ä¸Šæ˜ å¹´ä»½: ${movie.year}`
                                    ];
                                }
                            }
                        },
                        datalabels: {
                            anchor: 'end',
                            align: 'end',
                            color: '#fff',
                            font: {
                                size: 14,
                                weight: 'bold'
                            },
                            backgroundColor: 'rgba(0, 0, 0, 0.7)',
                            padding: 8,
                            borderRadius: 6,
                            formatter: (value) => `${value}`
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 10,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)',
                                drawBorder: false
                            },
                            ticks: {
                                font: {
                                    size: 12,
                                    weight: '500'
                                },
                                padding: 10
                            }
                        },
                        y: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 12,
                                    weight: '500'
                                },
                                padding: 15
                            }
                        }
                    },
                    animation: {
                        duration: 1800,
                        easing: 'easeOutQuart',
                        delay: function(context) {
                            return context.dataIndex * 100; // é€ä¸ªåŠ¨ç”»
                        },
                        onProgress: function(animation) {
                            const chart = this;
                            animation.animateScale = true;
                        }
                    },
                    hover: {
                        mode: 'index',
                        intersect: false,
                        onHover: function(event, elements) {
                            if (elements.length) {
                                event.native.target.style.cursor = 'pointer';
                            } else {
                                event.native.target.style.cursor = 'default';
                            }
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }

        // å¹´ä»£è¯„åˆ†è¶‹åŠ¿å›¾è¡¨ - ä½¿ç”¨æ¸å˜å¡«å……å’Œå¢å¼ºçš„è§†è§‰æ•ˆæœ
        function initDecadeRatingChart() {
            const ctx = document.getElementById('decadeRatingChart').getContext('2d');
            
            // åˆ›å»ºæ¸å˜å¡«å……
            const gradient = ctx.createLinearGradient(0, 0, 0, 400);
            gradient.addColorStop(0, colors.accent4.replace('0.85', '0.5'));
            gradient.addColorStop(0.5, colors.accent4.replace('0.85', '0.2'));
            gradient.addColorStop(1, colors.accent4.replace('0.85', '0'));
            
            // åˆ›å»ºçº¿æ¡æ¸å˜
            const lineGradient = ctx.createLinearGradient(0, 0, 400, 0);
            lineGradient.addColorStop(0, colors.accent4.replace('0.85', '0.7'));
            lineGradient.addColorStop(0.5, colors.accent3.replace('0.85', '0.9'));
            lineGradient.addColorStop(1, colors.accent4.replace('0.85', '0.7'));
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: movieData.decadeRating.map(item => item.decade),
                    datasets: [{
                        label: 'å¹³å‡è¯„åˆ†',
                        data: movieData.decadeRating.map(item => item.avgRating),
                        borderColor: lineGradient,
                        backgroundColor: gradient,
                        borderWidth: 5,
                        fill: true,
                        tension: 0.5,
                        pointBackgroundColor: colors.accent4,
                        pointBorderColor: '#fff',
                        pointBorderWidth: 4,
                        pointRadius: 10,
                        pointHoverRadius: 16,
                        pointHoverBackgroundColor: colors.accent3,
                        pointHoverBorderColor: '#fff',
                        pointHoverBorderWidth: 5,
                        pointShadowColor: 'rgba(239, 71, 111, 0.5)',
                        pointShadowBlur: 15,
                        pointShadowOffsetX: 0,
                        pointShadowOffsetY: 5,
                        pointHoverShadowColor: 'rgba(239, 71, 111, 0.8)',
                        pointHoverShadowBlur: 20,
                        pointHoverShadowOffsetX: 0,
                        pointHoverShadowOffsetY: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.85)',
                            padding: 15,
                            borderRadius: 10,
                            titleFont: {
                                size: 14,
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 13
                            },
                            callbacks: {
                                label: function(context) {
                                    return `å¹³å‡è¯„åˆ†: ${context.parsed.y}`;
                                }
                            }
                        },
                        datalabels: {
                            anchor: 'center',
                            align: 'center',
                            color: '#fff',
                            font: {
                                size: 12,
                                weight: 'bold'
                            },
                            formatter: (value) => `${value}`
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 8.5,
                            max: 9.5,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)',
                                drawBorder: false
                            },
                            ticks: {
                                font: {
                                    size: 12,
                                    weight: '500'
                                },
                                padding: 10,
                                callback: function(value) {
                                    return value.toFixed(1);
                                }
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 13,
                                    weight: '500'
                                },
                                padding: 15
                            }
                        }
                    },
                    animation: {
                        duration: 2500,
                        easing: 'easeOutQuart',
                        animateScale: true,
                        animateRotate: true
                    },
                    interaction: {
                        mode: 'index',
                        intersect: false,
                        axis: 'x'
                    },
                    hover: {
                        mode: 'nearest',
                        intersect: true
                    }
                },
                plugins: [ChartDataLabels]
            });
        }

        // æ›´æ–°ç»Ÿè®¡å¡ç‰‡æ•°æ®
        function updateStats() {
            if (movieData && movieData.topMovies) {
                document.getElementById('totalMovies').textContent = '250';
                
                // è®¡ç®—å¹³å‡è¯„åˆ†
                const avgRating = movieData.decadeRating.reduce((sum, item) => sum + item.avgRating, 0) / movieData.decadeRating.length;
                document.getElementById('avgRating').textContent = avgRating.toFixed(1);
                
                // è®¡ç®—æœ€é«˜è¯„åˆ†
                const maxRating = Math.max(...movieData.topMovies.map(item => item.rating));
                document.getElementById('maxRating').textContent = maxRating.toFixed(1);
                
                // è®¡ç®—å¹´ä»½è·¨åº¦
                const years = movieData.yearDistribution.map(item => item.year);
                const yearRange = Math.max(...years) - Math.min(...years);
                document.getElementById('yearRange').textContent = yearRange;
            } else {
                // ä½¿ç”¨é»˜è®¤å€¼
                document.getElementById('totalMovies').textContent = '250';
                document.getElementById('avgRating').textContent = '9.0';
                document.getElementById('maxRating').textContent = '9.7';
                document.getElementById('yearRange').textContent = '87';
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', async function() {
            await loadMovieData();
            updateStats();
            initCharts();
            
            // æ·»åŠ æŒ‰é’®äº‹ä»¶ç›‘å¬å™¨
            addButtonEventListeners();
        });
        
        // æ·»åŠ æŒ‰é’®äº‹ä»¶ç›‘å¬å™¨
        function addButtonEventListeners() {
            // æ›´æ–°æ•°æ®æŒ‰é’®
            document.getElementById('updateBtn').addEventListener('click', async function() {
                await handleUpdateData();
            });
            
            // åˆ‡æ¢å›¾è¡¨è§†å›¾æŒ‰é’®
            document.getElementById('toggleChartsBtn').addEventListener('click', function() {
                toggleChartView();
            });
        }
        
        // å¤„ç†æ•°æ®æ›´æ–°
        async function handleUpdateData() {
            const updateBtn = document.getElementById('updateBtn');
            const originalText = updateBtn.textContent;
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            updateBtn.textContent = 'â³ æ›´æ–°ä¸­...';
            updateBtn.disabled = true;
            updateBtn.style.opacity = '0.7';
            
            try {
                // æ·»åŠ åŠ è½½åŠ¨ç”»æ•ˆæœ
                const chartsGrid = document.querySelector('.charts-grid');
                chartsGrid.style.opacity = '0.5';
                chartsGrid.style.transition = 'opacity 0.3s ease';
                
                // é‡æ–°åŠ è½½æ•°æ®
                await loadMovieData();
                
                // æ¸…é™¤ç°æœ‰å›¾è¡¨
                clearCharts();
                
                // æ›´æ–°ç»Ÿè®¡å¡ç‰‡
                updateStats();
                
                // é‡æ–°åˆå§‹åŒ–å›¾è¡¨
                initCharts();
                
                // æ¢å¤æ­£å¸¸çŠ¶æ€
                chartsGrid.style.opacity = '1';
                updateBtn.textContent = 'âœ… æ›´æ–°æˆåŠŸ';
                updateBtn.style.backgroundColor = 'linear-gradient(135deg, #06D6A0, #00B894)';
                
                // å»¶è¿Ÿæ¢å¤æŒ‰é’®åŸå§‹çŠ¶æ€
                setTimeout(() => {
                    updateBtn.textContent = originalText;
                    updateBtn.style.background = 'linear-gradient(135deg, #FF6B6B, #EF476F)';
                    updateBtn.disabled = false;
                    updateBtn.style.opacity = '1';
                }, 1500);
                
            } catch (error) {
                console.error('æ•°æ®æ›´æ–°å¤±è´¥:', error);
                updateBtn.textContent = 'âŒ æ›´æ–°å¤±è´¥';
                updateBtn.style.backgroundColor = 'linear-gradient(135deg, #D63031, #B71540)';
                
                // å»¶è¿Ÿæ¢å¤æŒ‰é’®åŸå§‹çŠ¶æ€
                setTimeout(() => {
                    updateBtn.textContent = originalText;
                    updateBtn.style.background = 'linear-gradient(135deg, #FF6B6B, #EF476F)';
                    updateBtn.disabled = false;
                    updateBtn.style.opacity = '1';
                }, 1500);
            }
        }
        
        // æ¸…é™¤æ‰€æœ‰å›¾è¡¨å®ä¾‹
        function clearCharts() {
            // è·å–æ‰€æœ‰å›¾è¡¨ç”»å¸ƒ
            const chartCanvases = document.querySelectorAll('canvas[id$="Chart"]');
            
            // æ£€æŸ¥å¹¶é”€æ¯ç°æœ‰å›¾è¡¨å®ä¾‹
            chartCanvases.forEach(canvas => {
                const chartInstance = Chart.getChart(canvas);
                if (chartInstance) {
                    chartInstance.destroy();
                }
            });
        }
        
        // åˆ‡æ¢å›¾è¡¨è§†å›¾
        function toggleChartView() {
            const chartsGrid = document.querySelector('.charts-grid');
            const toggleBtn = document.getElementById('toggleChartsBtn');
            
            // åˆ‡æ¢å›¾è¡¨å¸ƒå±€ç±»
            if (chartsGrid.classList.contains('charts-list')) {
                // åˆ‡æ¢å›ç½‘æ ¼è§†å›¾
                chartsGrid.classList.remove('charts-list');
                toggleBtn.textContent = 'ğŸ“Š åˆ‡æ¢å›¾è¡¨è§†å›¾';
            } else {
                // åˆ‡æ¢åˆ°åˆ—è¡¨è§†å›¾
                chartsGrid.classList.add('charts-list');
                toggleBtn.textContent = 'ğŸ“‹ åˆ‡æ¢ç½‘æ ¼è§†å›¾';
            }
        }
        
        // æ·»åŠ CSSæ ·å¼ç”¨äºåˆ—è¡¨è§†å›¾
        const style = document.createElement('style');
        style.textContent = `
            /* å›¾è¡¨åˆ—è¡¨è§†å›¾æ ·å¼ */
            .charts-grid.charts-list {
                grid-template-columns: 1fr;
            }
            
            .charts-grid.charts-list .chart-container {
                transform: scale(0.95);
                transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            }
            
            .charts-grid.charts-list .chart-container:hover {
                transform: scale(0.98) translateY(-5px);
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>